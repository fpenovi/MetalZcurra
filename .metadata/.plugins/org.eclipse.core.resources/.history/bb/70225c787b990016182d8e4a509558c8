/*
 * Servidor.cpp
 *
 *  Created on: Oct 23, 2016
 *      Author: franch
 */

#include <stddef.h>
#include <stdio.h>
#include <pthread.h>
#include <iostream>
#include "utils/Calculadora.h"

using namespace std;


typedef struct control {
	Calculadora* calculadora;
} control_t;


void* threadFunction(void* arg) {

	Calculadora* calculadora = ((control_t*) arg)->calculadora;

	size_t result = calculadora->calcular(1000000000);

	return ((void*) &result);
}


int main() {

	pthread_t* thread = new pthread_t;
	control_t* arg = new control_t;
	arg->calculadora = new Calculadora();

	pthread_create(thread, NULL, threadFunction, arg);

	void* result;
	pthread_join(*thread, &result);
	cout << "Termino de calcular" << endl;
	cout << "Resultado del thread: " << *((size_t*)result) << endl;
	delete thread;
	delete arg->calculadora;
	delete arg;
	return 0;
}
